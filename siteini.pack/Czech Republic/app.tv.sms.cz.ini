**------------------------------------------------------------------------------------------------
* @header_start
* WebGrab+Plus ini for grabbing EPG data from TvGuide websites
* @Site: app.tv.sms.cz
* @MinSWversion: V5.0
* @Revision 0 - [04/08/2025] Blackbear199
*	- creation
* @Remarks: custom user agent required
*           SMSTVP/1.7.3 (242;cs_CZ) ID/ef284441-c1cd-4f9e-8e30-f5d8b1ac170c HW/Redmi Note 7 Android/10 (QKQ1.190910.002)
*           use channel grouping(see documentation)
*           Example...
*           <channels name="app.tv.sms.cz">
*           <user-agent>SMSTVP/1.7.3 (242;cs_CZ) ID/ef284441-c1cd-4f9e-8e30-f5d8b1ac170c HW/Redmi Note 7 Android/10 (QKQ1.190910.002)</user-agent>
*           <channel update="i" site="app.tv.sms.cz" site_id="15618" xmltv_id="Oneplay Sport 1">Oneplay Sport 1</channel>
*           <channel....
*           <channel....
*           </channels>
* @header_end
**------------------------------------------------------------------------------------------------
site {url=app.tv.sms.cz|timezone=Europe/Prague|maxdays=14|cultureinfo=cs-CZ|charset=utf-8|titlematchfactor=90|allowlastdayoverflow}
site {ratingsystem=CZ|episodesystem=onscreen}
*
scope.range {(urlindex)|end}
url_index {url|https://programandroid.365dni.cz/android/v6-program.php?datum=|urldate|&id_tv=##channel##}
url_index.headers {customheader=Accept-Encoding=gzip,deflate,br}
*
global_temp_1.modify {substring(type=regex)|'config_site_id' "^\d+"}
global_temp_2.modify {substring(type=regex)|'config_site_id' "^\d+##(.*)$"}
*
url_index.modify {replace|##channel##|'global_temp_1'}
*
urldate.format {datestring|yyyy-MM-dd}
end_scope
*
index_urlchannellogo.modify {set(scope=datelogo)|https://www.sms.cz/kategorie/televize/bmp/loga/velka/'global_temp_2'}
*
scope.range {(splitindex)|end}
index_showsplit.scrub {regex||<p.*?</p>||}
index_showsplit.modify {remove(type=element)|-1 1}
index_temp_9.modify {substring(type=regex)|'index_showsplit' "o=\"([^\"]*)"}
index_temp_9.modify {cleanup(removeduplicates link="index_showsplit")}
index_showsplit.modify {sort(ascending,string)}
sort_by.scrub  {single(target="index_showsplit")|o="||"|"}
sort_by.modify {calculate(target="index_showsplit" format=date,unix)}
*index_showsplit.modify {(debug)}
end_scope
*
scope.range {(indexshowdetails)|end}
index_start.scrub {single|o="||"|"}
index_stop.scrub {single|d="||"|"}
index_title.scrub {single|<n|>|</n>|</n>}
index_description.scrub {single|<k>||</k>|</k>}
index_temp_1.scrub {single|<e>||</e>|</e>} *L=Live,R=Repeat,P=Premiere
index_temp_2.scrub {single|<t>||</t>|</t>} *category code
*
index_description.modify {addstart('index_temp_1' "L")|Živé. }
index_previousshown.modify {set('index_temp_1' "R")|true}
index_premiere.modify {set('index_temp_1' "P")|true}
*
index_category.modify {set('index_temp_2' "F")|Film}
index_category.modify {set('index_temp_2' "S")|Serial}
index_category.modify {set('index_temp_2' "O")|Sport}
index_category.modify {set('index_temp_2' "Z")|Zprávy}
index_category.modify {set('index_temp_2' "L")|Zábava}
index_category.modify {set('index_temp_2' "D")|Dokum}
index_category.modify {set('index_temp_2' "Q")|Dětem}
index_category.modify {set('index_temp_2' "M")|Hudba}
*
index_episode.modify {substring(pattern="'S1' ('E1'/'Et1')""'S1'""('E1'/'Et1')" type=regex)|'index_title' "(?:[IXVLCMD]+\s\(\d+(?:\/\d+)?\)\|[IXVLCMD]+\|\s\(\d+(?:\/\d+)?\))$"}
index_title.modify {remove('index_episode' not "")|'index_episode'}
index_episode.modify {cleanup(style=roman2arabicnumeral)}
end_scope
**  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _
**      #####  CHANNEL FILE CREATION (only to create the xxx-channel.xml file)
**
** @auto_xml_channel_start
*scope.range {(urlindex)|end}
*url_index {url|https://programandroid.365dni.cz/android/v6-tv.php?locale=cs_CZ}
*end_scope
*scope.range {(channellist)|end}
*index_site_id.scrub {multi|id="||</o>|</o>}
*index_site_channel.scrub {multi|<n>||</n>|</n>}
*index_site_id.modify {replace(type=regex)|"^\d+(.*>)"|##}
*index_site_id.modify {cleanup(removeduplicates link="index_site_channel")}
*end_scope
** @auto_xml_channel_end
